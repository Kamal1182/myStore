(self.webpackChunkcontacts_manager=self.webpackChunkcontacts_manager||[]).push([[930],{1930:(e,r,t)=>{"use strict";t.r(r),t.d(r,{UsersModule:()=>te});var a=t(1116),o=t(3337),s=t(5609),i=t(9241),n=t(9199),d=t(8378),u=t(9996),l=t(1520),m=t(8512),c=t(1906),p=t(7371);class g extends d.o2{constructor(e){super(),this.api=e,this.USERS=[],this.usersSubject=new m.X([]),this.loadingSubject=new m.X(!1),this.loading$=this.loadingSubject.asObservable()}connect(){if(this.paginator&&this.sort)return this.usersSubject.subscribe(e=>this.USERS=e),(0,c.T)(this.usersSubject,this.paginator.page,this.sort.sortChange).pipe((0,u.U)(()=>this.getPagedData(this.getSortedData([...this.USERS]))));throw Error("Please set the paginator and sort on the data source before connecting.")}disconnect(){}loadUsers(){this.loadingSubject.next(!0),this.api.get("users").pipe((0,l.x)(()=>this.loadingSubject.next(!1))).subscribe(e=>{this.usersSubject.next(e)})}getPagedData(e){return this.paginator?e.splice(this.paginator.pageIndex*this.paginator.pageSize,this.paginator.pageSize):e}getSortedData(e){return this.sort&&this.sort.active&&""!==this.sort.direction?e.sort((e,r)=>{var t,a;const o="asc"===(null===(t=this.sort)||void 0===t?void 0:t.direction);switch(null===(a=this.sort)||void 0===a?void 0:a.active){case"_id":return h(e._id,r._id,o);case"username":return h(e.username.toLowerCase(),r.username.toLowerCase(),o);case"admin":return h(+e.admin,+r.admin,o);default:return 0}}):e}}function h(e,r,t){return(e<r?-1:1)*(t?1:-1)}var Z=t(2935),f=t(5366),U=t(3589),q=t(4369);let w=(()=>{class e{constructor(e,r,t,a){this.deleteDialogRef=r,this.api=t,this._DeleteUserSnackBar=a,this.user=e}ngOnInit(){}deleteUser(){this.api.delete("users/"+this.user._id).subscribe(e=>{401==e.statusCode?alert(e.error):(console.log(e),this._DeleteUserSnackBar.open(`${this.user.username}`,"Deleted!",{duration:5e3}),this.api.makeRefresh(),this.deleteDialogRef.close())})}}return e.\u0275fac=function(r){return new(r||e)(f.Y36(Z.WI),f.Y36(Z.so),f.Y36(p.s),f.Y36(U.ux))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-delete-user-modal"]],decls:12,vars:1,consts:[[1,"add-title"],["mat-dialog-title",""],[1,"text-danger"],["mat-raised-button","","color","warn",3,"click"]],template:function(e,r){1&e&&(f.TgZ(0,"div",0),f.TgZ(1,"h2",1),f._uU(2,"Delete User ( "),f.TgZ(3,"strong"),f._uU(4),f.qZA(),f._uU(5," ) data! "),f.qZA(),f.qZA(),f.TgZ(6,"p"),f._uU(7,"All information associated to this user will be permanently deleted. "),f.TgZ(8,"span",2),f._uU(9,"This operation can not be undone."),f.qZA(),f.qZA(),f.TgZ(10,"button",3),f.NdJ("click",function(){return r.deleteUser()}),f._uU(11,"Delete"),f.qZA()),2&e&&(f.xp6(4),f.Oqu(r.user.username))},directives:[Z.uh,q.lW],styles:[""]}),e})();var A=t(1041),b=t(2309),_=t(3070),v=t(9550),T=t(7436),S=t(7307),x=t(7672);function E(e,r){1&e&&(f.TgZ(0,"div",18),f._UZ(1,"mat-spinner",19),f.qZA())}function N(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Enter user name"),f.qZA())}function C(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Choose admin or not!"),f.qZA())}function k(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Enter password!"),f.qZA())}function I(e,r){if(1&e&&(f.TgZ(0,"mat-error"),f._uU(1),f.qZA()),2&e){const e=f.oxw();f.xp6(1),f.Oqu(e.passwordServerError)}}let J=(()=>{class e{constructor(e,r,t,a,o){this.fb=e,this.editDialogRef=t,this.api=a,this._EditedUserSnackBar=o,this.loading=!1,this.usernameServerError="",this.adminServerError="",this.passwordServerError="",this.user=r}ngOnInit(){this.editUserForm=this.fb.group({username:[this.user.username?this.user.username:"",A.kI.required],admin:[this.user.admin,A.kI.required],password:["",A.kI.required]})}onSubmit(){this.loading=!0;const e=Object.assign({},this.editUserForm.value);this.api.put("users/"+this.user._id,{_id:this.user._id,username:e.username,admin:e.admin,password:e.password}).subscribe(e=>{var r,t,a;401==e.statusCode?alert(e.error):422==e.statusCode?(console.log("from edit-user-modal.component.js"+JSON.stringify(e.error)),e.error.username&&(null===(r=this.editUserForm.get("username"))||void 0===r||r.setErrors({[`${e.error.username}`]:!0}),this.usernameServerError=e.error.username),e.error.admin&&(null===(t=this.editUserForm.get("admin"))||void 0===t||t.setErrors({[`${e.error.admin}`]:!0}),this.adminServerError=e.error.admin),e.error.password&&(null===(a=this.editUserForm.get("password"))||void 0===a||a.setErrors({[`${e.error.password}`]:!0}),this.passwordServerError=e.error.password)):(this._EditedUserSnackBar.open(`${this.user.username}`,"Edited!",{duration:5e3}),this.api.makeRefresh(),this.editDialogRef.close())})}onResize(e){this.breakpoint=e.target.innerWidth<=600?1:2}}return e.\u0275fac=function(r){return new(r||e)(f.Y36(A.qu),f.Y36(Z.WI),f.Y36(Z.so),f.Y36(p.s),f.Y36(U.ux))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-edit-user-modal"]],decls:46,vars:19,consts:[[1,"dialog-container"],["class","loader-container",4,"ngIf"],[1,"add-title"],["mat-dialog-title",""],["novalidate","",3,"formGroup","ngSubmit"],["rowHeight","85px",3,"cols","resize"],["gridList",""],["matInput","","placeholder","User Name","type","text","formControlName","username"],["username",""],[4,"ngIf"],["matInput","","formControlName","admin","required","",2,"display","none"],["matInput","","formControlName","admin","aria-label","Admin"],["admin",""],[3,"value","checked"],["matInput","","type","password","formControlName","password","placeholder","password","required",""],["password",""],["matSuffix",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"loader-container"],[2,"top","50%","left","50%"]],template:function(e,r){1&e&&(f.TgZ(0,"div",0),f.YNc(1,E,2,0,"div",1),f.ALo(2,"async"),f.TgZ(3,"div",2),f.TgZ(4,"h2",3),f._uU(5,"Edit User ( "),f.TgZ(6,"strong"),f._uU(7),f.qZA(),f._uU(8," ) data "),f.qZA(),f.qZA(),f.TgZ(9,"mat-dialog-content"),f.TgZ(10,"form",4),f.NdJ("ngSubmit",function(){return r.onSubmit()}),f.TgZ(11,"mat-grid-list",5,6),f.NdJ("resize",function(e){return r.onResize(e)},!1,f.Jf7),f.TgZ(13,"mat-grid-tile"),f.TgZ(14,"mat-form-field"),f._UZ(15,"input",7,8),f.YNc(17,N,2,0,"mat-error",9),f.TgZ(18,"mat-error"),f._uU(19),f.qZA(),f.qZA(),f.qZA(),f.TgZ(20,"mat-grid-tile"),f.TgZ(21,"mat-form-field"),f.TgZ(22,"mat-label"),f._uU(23,"Admin"),f.qZA(),f._UZ(24,"input",10),f.TgZ(25,"mat-radio-group",11,12),f.TgZ(27,"mat-radio-button",13),f._uU(28,"True"),f.qZA(),f.TgZ(29,"mat-radio-button",13),f._uU(30,"False"),f.qZA(),f.qZA(),f.YNc(31,C,2,0,"mat-error",9),f.TgZ(32,"mat-error"),f._uU(33),f.qZA(),f.qZA(),f.qZA(),f.TgZ(34,"mat-grid-tile"),f.TgZ(35,"mat-form-field"),f.TgZ(36,"mat-label"),f._uU(37,"Password"),f.qZA(),f._UZ(38,"input",14,15),f.TgZ(40,"mat-icon",16),f._uU(41,"password"),f.qZA(),f.YNc(42,k,2,0,"mat-error",9),f.YNc(43,I,2,1,"mat-error",9),f.qZA(),f.qZA(),f.qZA(),f.TgZ(44,"button",17),f._uU(45,"Edit"),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(1),f.Q6J("ngIf",f.lcZ(2,17,r.api.isLoading)),f.xp6(6),f.Oqu(r.user.username),f.xp6(3),f.ekj("loading",r.loading),f.Q6J("formGroup",r.editUserForm),f.xp6(1),f.Q6J("cols",r.breakpoint),f.xp6(6),f.Q6J("ngIf",null==r.editUserForm.controls.username.errors?null:r.editUserForm.controls.username.errors.required),f.xp6(2),f.Oqu(r.usernameServerError),f.xp6(8),f.Q6J("value",!0)("checked",r.user.admin),f.xp6(2),f.Q6J("value",!1)("checked",!r.user.admin),f.xp6(2),f.Q6J("ngIf",null==r.editUserForm.controls.admin.errors?null:r.editUserForm.controls.admin.errors.required),f.xp6(2),f.Oqu(r.adminServerError),f.xp6(9),f.Q6J("ngIf",null==r.editUserForm.controls.password.errors?null:r.editUserForm.controls.password.errors.required),f.xp6(1),f.Q6J("ngIf",r.passwordServerError),f.xp6(1),f.Q6J("disabled",r.editUserForm.invalid))},directives:[a.O5,Z.uh,Z.xY,A._Y,A.JL,A.sg,b.Il,b.DX,_.KE,v.Nt,A.Fj,A.JJ,A.u,_.TO,_.hX,A.Q7,T.VQ,T.U0,S.Hw,_.R9,q.lW,x.$g],pipes:[a.Ov],styles:[".mat-radio-button[_ngcontent-%COMP%]{margin:0 12px}.dialog-container[_ngcontent-%COMP%]{position:relative}.loader-container[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;background:#000;opacity:.8;z-index:99999}"]}),e})();function Y(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Enter user name"),f.qZA())}function y(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Choose admin or not!"),f.qZA())}function D(e,r){1&e&&(f.TgZ(0,"mat-error"),f._uU(1,"Enter password!"),f.qZA())}function O(e,r){if(1&e&&(f.TgZ(0,"mat-error"),f._uU(1),f.qZA()),2&e){const e=f.oxw();f.xp6(1),f.Oqu(e.passwordServerError)}}let F=(()=>{class e{constructor(e,r,t,a){this.fb=e,this.editDialogRef=r,this.api=t,this._EditedUserSnackBar=a,this.loading=!1,this.usernameServerError="",this.adminServerError="",this.passwordServerError=""}ngOnInit(){this.editUserForm=this.fb.group({username:["",A.kI.required],admin:[!0,A.kI.required],password:["",A.kI.required]})}onSubmit(){this.loading=!0;const e=Object.assign({},this.editUserForm.value),r={_id:void 0,username:e.username,admin:e.admin,password:e.password};console.log(r),this.api.post("users/",r).subscribe(e=>{var r,t,a;401==e.statusCode?alert(e.error):422==e.statusCode?(console.log("from add-user-modal.component.js"+JSON.stringify(e.error)),e.error.username&&(null===(r=this.editUserForm.get("username"))||void 0===r||r.setErrors({[`${e.error.username}`]:!0}),this.usernameServerError=e.error.username),e.error.admin&&(null===(t=this.editUserForm.get("admin"))||void 0===t||t.setErrors({[`${e.error.admin}`]:!0}),this.adminServerError=e.error.admin),e.error.password&&(null===(a=this.editUserForm.get("password"))||void 0===a||a.setErrors({[`${e.error.password}`]:!0}),this.passwordServerError=e.error.password)):(console.log(e),this.newUser=e,this._EditedUserSnackBar.open(`${this.newUser.username}`,"Added!",{duration:5e3}),this.api.makeRefresh(),this.editDialogRef.close())})}onResize(e){this.breakpoint=e.target.innerWidth<=600?1:2}}return e.\u0275fac=function(r){return new(r||e)(f.Y36(A.qu),f.Y36(Z.so),f.Y36(p.s),f.Y36(U.ux))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-add-user-modal"]],decls:40,vars:13,consts:[[1,"add-title"],["mat-dialog-title",""],["novalidate","",3,"formGroup","ngSubmit"],["rowHeight","85px",3,"cols","resize"],["gridList",""],["matInput","","placeholder","User Name","type","text","formControlName","username"],["username",""],[4,"ngIf"],["matInput","","formControlName","admin","required","",2,"display","none"],["matInput","","formControlName","admin","aria-label","Admin"],["admin",""],[3,"value"],["matInput","","type","password","formControlName","password","placeholder","password","required",""],["password",""],["matSuffix",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"]],template:function(e,r){1&e&&(f.TgZ(0,"div",0),f.TgZ(1,"h2",1),f._uU(2,"Add New User"),f.qZA(),f.qZA(),f.TgZ(3,"mat-dialog-content"),f.TgZ(4,"form",2),f.NdJ("ngSubmit",function(){return r.onSubmit()}),f.TgZ(5,"mat-grid-list",3,4),f.NdJ("resize",function(e){return r.onResize(e)},!1,f.Jf7),f.TgZ(7,"mat-grid-tile"),f.TgZ(8,"mat-form-field"),f._UZ(9,"input",5,6),f.YNc(11,Y,2,0,"mat-error",7),f.TgZ(12,"mat-error"),f._uU(13),f.qZA(),f.qZA(),f.qZA(),f.TgZ(14,"mat-grid-tile"),f.TgZ(15,"mat-form-field"),f.TgZ(16,"mat-label"),f._uU(17,"Admin"),f.qZA(),f._UZ(18,"input",8),f.TgZ(19,"mat-radio-group",9,10),f.TgZ(21,"mat-radio-button",11),f._uU(22,"True"),f.qZA(),f.TgZ(23,"mat-radio-button",11),f._uU(24,"False"),f.qZA(),f.qZA(),f.YNc(25,y,2,0,"mat-error",7),f.TgZ(26,"mat-error"),f._uU(27),f.qZA(),f.qZA(),f.qZA(),f.TgZ(28,"mat-grid-tile"),f.TgZ(29,"mat-form-field"),f.TgZ(30,"mat-label"),f._uU(31,"Password"),f.qZA(),f._UZ(32,"input",12,13),f.TgZ(34,"mat-icon",14),f._uU(35,"password"),f.qZA(),f.YNc(36,D,2,0,"mat-error",7),f.YNc(37,O,2,1,"mat-error",7),f.qZA(),f.qZA(),f.qZA(),f.TgZ(38,"button",15),f._uU(39,"Add"),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(4),f.ekj("loading",r.loading),f.Q6J("formGroup",r.editUserForm),f.xp6(1),f.Q6J("cols",r.breakpoint),f.xp6(6),f.Q6J("ngIf",null==r.editUserForm.controls.username.errors?null:r.editUserForm.controls.username.errors.required),f.xp6(2),f.Oqu(r.usernameServerError),f.xp6(8),f.Q6J("value",!0),f.xp6(2),f.Q6J("value",!1),f.xp6(2),f.Q6J("ngIf",null==r.editUserForm.controls.admin.errors?null:r.editUserForm.controls.admin.errors.required),f.xp6(2),f.Oqu(r.adminServerError),f.xp6(9),f.Q6J("ngIf",null==r.editUserForm.controls.password.errors?null:r.editUserForm.controls.password.errors.required),f.xp6(1),f.Q6J("ngIf",r.passwordServerError),f.xp6(1),f.Q6J("disabled",r.editUserForm.invalid))},directives:[Z.uh,Z.xY,A._Y,A.JL,A.sg,b.Il,b.DX,_.KE,v.Nt,A.Fj,A.JJ,A.u,a.O5,_.TO,_.hX,A.Q7,T.VQ,T.U0,S.Hw,_.R9,q.lW],styles:[".mat-radio-button[_ngcontent-%COMP%]{margin:0 12px}"]}),e})();function Q(e,r){1&e&&(f.TgZ(0,"div",15),f._UZ(1,"mat-spinner"),f.qZA())}function R(e,r){1&e&&(f.TgZ(0,"mat-header-cell",16),f._uU(1,"Id"),f.qZA())}function z(e,r){if(1&e&&(f.TgZ(0,"mat-cell",17),f._uU(1),f.qZA()),2&e){const e=r.$implicit;f.xp6(1),f.Oqu(e._id)}}function j(e,r){1&e&&(f.TgZ(0,"mat-header-cell",16),f._uU(1,"User Name"),f.qZA())}function $(e,r){if(1&e&&(f.TgZ(0,"mat-cell",17),f._uU(1),f.qZA()),2&e){const e=r.$implicit;f.xp6(1),f.Oqu(e.username)}}function B(e,r){1&e&&(f.TgZ(0,"mat-header-cell",16),f._uU(1,"Admin"),f.qZA())}function M(e,r){if(1&e&&(f.TgZ(0,"mat-cell",17),f._uU(1),f.qZA()),2&e){const e=r.$implicit;f.xp6(1),f.Oqu(e.admin)}}function H(e,r){1&e&&(f.TgZ(0,"mat-header-cell",16),f._uU(1,"Delete"),f.qZA())}function X(e,r){if(1&e){const e=f.EpF();f.TgZ(0,"mat-cell",17),f.TgZ(1,"button",18),f.NdJ("click",function(){const r=f.CHM(e).$implicit;return f.oxw().deleteUserDialog(r)}),f._uU(2,"Delete"),f.qZA(),f.qZA()}}function G(e,r){1&e&&(f.TgZ(0,"mat-header-cell",16),f._uU(1,"Edit"),f.qZA())}function P(e,r){if(1&e){const e=f.EpF();f.TgZ(0,"mat-cell",17),f.TgZ(1,"button",19),f.NdJ("click",function(){const r=f.CHM(e).$implicit;return f.oxw().editUserDialog(r)}),f._uU(2,"Edit"),f.qZA(),f.qZA()}}function W(e,r){1&e&&f._UZ(0,"mat-header-row",20)}function L(e,r){1&e&&f._UZ(0,"mat-row",21)}const V=function(){return[5,10,20]},K=[{path:"",component:(()=>{class e{constructor(e,r){this.api=e,this.dialog=r,this.displayedColumns=["_id","username","admin","edit","delete"],e.refreshCall$.subscribe(()=>{this.refeshContacts(null)})}refeshContacts(e){this.ngOnInit(),this.ngAfterViewInit()}ngOnInit(){this.dataSource=new g(this.api),this.dataSource.loadUsers()}ngAfterViewInit(){this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator,this.table.dataSource=this.dataSource}deleteUserDialog(e){const r=new Z.vA;r.autoFocus=!0,r.width="320px",r.data=e,this.dialog.open(w,r)}editUserDialog(e){const r=new Z.vA;r.autoFocus=!0,r.width="320px",r.data=e,this.dialog.open(J,r)}addUserDialog(){const e=new Z.vA;e.autoFocus=!0,e.width="320px",this.dialog.open(F,e)}}return e.\u0275fac=function(r){return new(r||e)(f.Y36(p.s),f.Y36(Z.uw))},e.\u0275cmp=f.Xpm({type:e,selectors:[["app-users-table"]],viewQuery:function(e,r){if(1&e&&(f.Gf(s.NW,5),f.Gf(i.YE,5),f.Gf(n.BZ,5)),2&e){let e;f.iGM(e=f.CRH())&&(r.paginator=e.first),f.iGM(e=f.CRH())&&(r.sort=e.first),f.iGM(e=f.CRH())&&(r.table=e.first)}},decls:26,vars:10,consts:[["mat-raised-button","","matSuffix","","mat-stroked-button","","color","primary",3,"click"],[1,"mat-elevation-z8","users-table"],["class","spinner-container overlay",4,"ngIf"],["mat-table","","matSort","","aria-label","Elements",1,"full-width-table"],["matColumnDef","_id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","username"],["matColumnDef","admin"],["matColumnDef","delete"],["matColumnDef","edit"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","pageIndex","pageSize","pageSizeOptions"],["paginator",""],[1,"spinner-container","overlay"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,r){1&e&&(f.TgZ(0,"div"),f.TgZ(1,"button",0),f.NdJ("click",function(){return r.addUserDialog()}),f._uU(2,"Add New User"),f.qZA(),f.qZA(),f.TgZ(3,"div",1),f.YNc(4,Q,2,0,"div",2),f.ALo(5,"async"),f.TgZ(6,"table",3),f.ynx(7,4),f.YNc(8,R,2,0,"mat-header-cell",5),f.YNc(9,z,2,1,"mat-cell",6),f.BQk(),f.ynx(10,7),f.YNc(11,j,2,0,"mat-header-cell",5),f.YNc(12,$,2,1,"mat-cell",6),f.BQk(),f.ynx(13,8),f.YNc(14,B,2,0,"mat-header-cell",5),f.YNc(15,M,2,1,"mat-cell",6),f.BQk(),f.ynx(16,9),f.YNc(17,H,2,0,"mat-header-cell",5),f.YNc(18,X,3,0,"mat-cell",6),f.BQk(),f.ynx(19,10),f.YNc(20,G,2,0,"mat-header-cell",5),f.YNc(21,P,3,0,"mat-cell",6),f.BQk(),f.YNc(22,W,1,0,"mat-header-row",11),f.YNc(23,L,1,0,"mat-row",12),f.qZA(),f._UZ(24,"mat-paginator",13,14),f.qZA()),2&e&&(f.xp6(4),f.Q6J("ngIf",f.lcZ(5,7,r.dataSource.loading$)),f.xp6(18),f.Q6J("matHeaderRowDef",r.displayedColumns),f.xp6(1),f.Q6J("matRowDefColumns",r.displayedColumns),f.xp6(1),f.Q6J("length",null==r.dataSource||null==r.dataSource.USERS?null:r.dataSource.USERS.length)("pageIndex",0)("pageSize",10)("pageSizeOptions",f.DdM(9,V)))},directives:[q.lW,_.R9,a.O5,n.BZ,i.YE,n.w1,n.fO,n.Dz,n.as,n.nj,s.NW,x.$g,n.ge,i.nU,n.ev,n.XQ,n.Gk],pipes:[a.Ov],styles:[".users-table[_ngcontent-%COMP%]{width:80%;margin:20px auto}.full-width-table[_ngcontent-%COMP%]{width:100%}"]}),e})()}];let ee=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({imports:[[o.Bz.forChild(K)],o.Bz]}),e})();var re=t(3855);let te=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({imports:[[a.ez,ee,re.h,A.u5,A.UX]]}),e})()}}]);